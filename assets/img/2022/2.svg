<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than diagrams.net -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1731px" height="801px" viewBox="-0.5 -0.5 1731 801" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2022-08-15T00:26:55.598Z&quot; agent=&quot;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/19.0.3 Chrome/102.0.5005.63 Electron/19.0.3 Safari/537.36&quot; etag=&quot;rvnIdz-HPi0RYS16nsek&quot; version=&quot;19.0.3&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;dE8GBDc9YQ1ct4YA8N1H&quot; name=&quot;第 1 页&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><rect x="670" y="70" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 85px; margin-left: 671px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">aaaa</div></div></div></foreignObject><text x="725" y="90" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">aaaa</text></switch></g><rect x="670" y="100" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 115px; margin-left: 671px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><span style="font-size: 16px;">buf1</span></div></div></div></foreignObject><text x="725" y="120" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">buf1</text></switch></g><rect x="670" y="130" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 145px; margin-left: 671px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">read_plt</div></div></div></foreignObject><text x="725" y="150" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">read_plt</text></switch></g><rect x="670" y="160" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 175px; margin-left: 671px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">leave_ret</div></div></div></foreignObject><text x="725" y="180" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">leave_ret</text></switch></g><rect x="670" y="190" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 205px; margin-left: 671px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">0</div></div></div></foreignObject><text x="725" y="210" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">0</text></switch></g><rect x="670" y="220" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 235px; margin-left: 671px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">buf1</div></div></div></foreignObject><text x="725" y="240" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">buf1</text></switch></g><rect x="670" y="250" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 265px; margin-left: 671px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">0x100</div></div></div></foreignObject><text x="725" y="270" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">0x100</text></switch></g><rect x="670" y="280" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><rect x="670" y="310" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><rect x="625" y="105" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 115px; margin-left: 645px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">ebp</div></div></div></foreignObject><text x="645" y="120" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">ebp</text></switch></g><rect x="670" y="40" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 55px; margin-left: 671px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">aaaa</div></div></div></foreignObject><text x="725" y="60" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">aaaa</text></switch></g><rect x="625" y="45" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 55px; margin-left: 645px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">esp</div></div></div></foreignObject><text x="645" y="60" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">esp</text></switch></g><rect x="700" y="0" width="50" height="20" fill="#6a00ff" stroke="#3700cc" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 10px; margin-left: 725px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: nowrap;">stack</div></div></div></foreignObject><text x="725" y="15" fill="#ffffff" font-family="Helvetica" font-size="16px" text-anchor="middle">stack</text></switch></g><rect x="1040" y="70" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 85px; margin-left: 1041px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">system</div></div></div></foreignObject><text x="1095" y="90" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">system</text></switch></g><rect x="1040" y="100" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 115px; margin-left: 1041px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">0xdeadbeef</div></div></div></foreignObject><text x="1095" y="120" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">0xdeadbeef</text></switch></g><rect x="1040" y="130" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 145px; margin-left: 1041px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">&amp;/bin/sh</div></div></div></foreignObject><text x="1095" y="150" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">&amp;/bin/sh</text></switch></g><rect x="1040" y="160" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 175px; margin-left: 1041px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">/bin/sh</div></div></div></foreignObject><text x="1095" y="180" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">/bin/sh</text></switch></g><rect x="1040" y="190" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><rect x="1040" y="220" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><rect x="1040" y="250" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><rect x="1040" y="280" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><rect x="1040" y="310" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><rect x="1040" y="40" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 55px; margin-left: 1041px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">buf1</div></div></div></foreignObject><text x="1095" y="60" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">buf1</text></switch></g><rect x="1070" y="0" width="50" height="20" fill="#6a00ff" stroke="#3700cc" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 10px; margin-left: 1095px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: nowrap;">buf2</div></div></div></foreignObject><text x="1095" y="15" fill="#ffffff" font-family="Helvetica" font-size="16px" text-anchor="middle">buf2</text></switch></g><rect x="780" y="360" width="430" height="100" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 410px; margin-left: 782px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">首先触发栈溢出<br style="font-size: 16px;" />ebp中写入buf1的地址（buf1取一个bss段的地址）<br style="font-size: 16px;" />目的是把buf1当做临时的第二个栈，后面会搬迁过去<br style="font-size: 16px;" />这次栈溢出的目的是向buf1中写入gadget<br style="font-size: 16px;" />所以应该要调用read或者gets啥的，看程序中能用啥就用啥</div></div></div></foreignObject><text x="782" y="415" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px">首先触发栈溢出ebp中写入buf1的地址（buf1取一个bss段的地址）...</text></switch></g><rect x="240" y="40" width="350" height="60" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 70px; margin-left: 242px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">栈迁移最关键的利用是通过leave指令<br style="font-size: 16px;" />leave = mov esp, ebp; pop ebp;<br style="font-size: 16px;" />通过pop ebp; 把ebp指到恶意构造的地址上去！</div></div></div></foreignObject><text x="242" y="75" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px">栈迁移最关键的利用是通过leave指令...</text></switch></g><rect x="864" y="70" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 85px; margin-left: 865px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">puts_plt</div></div></div></foreignObject><text x="919" y="90" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">puts_plt</text></switch></g><rect x="864" y="100" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 115px; margin-left: 865px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">pop_ebx; ret</div></div></div></foreignObject><text x="919" y="120" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">pop_ebx; ret</text></switch></g><rect x="864" y="130" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 145px; margin-left: 865px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">puts_got</div></div></div></foreignObject><text x="919" y="150" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">puts_got</text></switch></g><rect x="864" y="160" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 175px; margin-left: 865px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">read_plt</div></div></div></foreignObject><text x="919" y="180" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">read_plt</text></switch></g><rect x="864" y="190" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 205px; margin-left: 865px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">leave_ret</div></div></div></foreignObject><text x="919" y="210" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">leave_ret</text></switch></g><rect x="864" y="220" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 235px; margin-left: 865px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">0</div></div></div></foreignObject><text x="919" y="240" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">0</text></switch></g><rect x="864" y="250" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 265px; margin-left: 865px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">buf2</div></div></div></foreignObject><text x="919" y="270" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">buf2</text></switch></g><rect x="864" y="280" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 295px; margin-left: 865px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">0x100</div></div></div></foreignObject><text x="919" y="300" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">0x100</text></switch></g><rect x="864" y="310" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><rect x="864" y="40" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 55px; margin-left: 865px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">buf2</div></div></div></foreignObject><text x="919" y="60" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">buf2</text></switch></g><rect x="894" y="0" width="50" height="20" fill="#6a00ff" stroke="#3700cc" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 10px; margin-left: 919px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: nowrap;">buf1</div></div></div></foreignObject><text x="919" y="15" fill="#ffffff" font-family="Helvetica" font-size="16px" text-anchor="middle">buf1</text></switch></g><rect x="820" y="45" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 55px; margin-left: 840px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">ebp</div></div></div></foreignObject><text x="840" y="60" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">ebp</text></switch></g><rect x="1000" y="45" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 55px; margin-left: 1020px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">ebp</div></div></div></foreignObject><text x="1020" y="60" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">ebp</text></switch></g><path d="M 590 175 L 663.63 175" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 668.88 175 L 661.88 178.5 L 663.63 175 L 661.88 171.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="0" y="145" width="590" height="60" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 175px; margin-left: 2px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">关键点：leave_ret<br style="font-size: 16px;" />leave把ebp指到buf2(这个buf2是指最右边那排的那个)，把esp指到buf1的puts_plt<br style="font-size: 16px;" />然后ret，puts_plt放进eip中执行。</div></div></div></foreignObject><text x="2" y="180" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px">关键点：leave_ret...</text></switch></g><rect x="645" y="400" width="130" height="20" fill="#6a00ff" stroke="#3700cc" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 410px; margin-left: 710px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: nowrap;">关于stack的构造</div></div></div></foreignObject><text x="710" y="415" fill="#ffffff" font-family="Helvetica" font-size="16px" text-anchor="middle">关于stack的构造</text></switch></g><rect x="645" y="524" width="130" height="20" fill="#6a00ff" stroke="#3700cc" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 534px; margin-left: 710px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: nowrap;">关于buf1的构造</div></div></div></foreignObject><text x="710" y="539" fill="#ffffff" font-family="Helvetica" font-size="16px" text-anchor="middle">关于buf1的构造</text></switch></g><rect x="780" y="485" width="740" height="200" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 585px; margin-left: 782px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">stack中的gadget触发read，向buf1中写入gadget<br style="font-size: 16px;" />首先写入的是第三个栈的地址buf2<br style="font-size: 16px;" />然后buf1这个栈的目的有两个<br style="font-size: 16px;" />1、泄露libc地址，所以一般会通过调用puts_plt，打印puts_got值<br style="font-size: 16px;" />2、继续调用read_plt，向buf2中写入gadget，这一条的思路和stack中的gadget思路是一样的<br style="font-size: 16px;" /><br style="font-size: 16px;" />puts_plt下一格是返回地址，如果这里塞read_plt的话，read_plt的返回地址就是puts_got了，<br style="font-size: 16px;" />我们想要的返回地址gadget应该是leave_ret，这样可以把栈再迁移到buf2了<br style="font-size: 16px;" />所以这一格的内容，需要修一下esp，要么用pop xxx; ret  要么用add esp, xxx; ret 或者 sub esp,xxx; ret<br style="font-size: 16px;" />这题就用 =&gt; 0x0804836d : pop ebx ; ret  这个gadget了</div></div></div></foreignObject><text x="782" y="590" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px">stack中的gadget触发read，向buf1中写入gadget...</text></switch></g><rect x="645" y="750" width="130" height="20" fill="#6a00ff" stroke="#3700cc" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 760px; margin-left: 710px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: nowrap;">关于buf2的构造</div></div></div></foreignObject><text x="710" y="765" fill="#ffffff" font-family="Helvetica" font-size="16px" text-anchor="middle">关于buf2的构造</text></switch></g><rect x="780" y="720" width="950" height="80" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 760px; margin-left: 782px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">首先写入buf1的地址，再把栈迁到buf1中。也就是栈在buf1和buf2来回横跳。但是这题在buf2中就拿到shell了，不会再回到buf1<br style="font-size: 16px;" />buf2这个栈的目的是执行system("/bin/sh")<br style="font-size: 16px;" />system的地址通过buf1中的leak可以计算到<br style="font-size: 16px;" />/bin/sh在libc中也有。假设没有现成的/bin/sh的话，/bin/sh可以在buf2中写入，然后稍微计算一下偏移，把这个地址传给system做参数</div></div></div></foreignObject><text x="782" y="765" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px">首先写入buf1的地址，再把栈迁到buf1中。也就是栈在buf1和buf2来回横跳。但是这题在buf2中就拿到shell了，不会再回到buf1...</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>