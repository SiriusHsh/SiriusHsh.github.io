<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than diagrams.net -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1611px" height="796px" viewBox="-0.5 -0.5 1611 796" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2022-08-15T13:23:57.328Z&quot; agent=&quot;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/19.0.3 Chrome/102.0.5005.63 Electron/19.0.3 Safari/537.36&quot; etag=&quot;bLfES4WM52hq63z_RcPN&quot; version=&quot;19.0.3&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;dE8GBDc9YQ1ct4YA8N1H&quot; name=&quot;第 1 页&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><rect x="670" y="70" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 85px; margin-left: 671px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">aaaa</div></div></div></foreignObject><text x="725" y="89" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">aaaa</text></switch></g><rect x="670" y="100" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 115px; margin-left: 671px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><span style="font-size: 14px;">buf1</span></div></div></div></foreignObject><text x="725" y="119" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">buf1</text></switch></g><rect x="670" y="130" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 145px; margin-left: 671px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">read_plt</div></div></div></foreignObject><text x="725" y="149" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">read_plt</text></switch></g><rect x="670" y="160" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 175px; margin-left: 671px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">leave_ret</div></div></div></foreignObject><text x="725" y="179" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">leave_ret</text></switch></g><rect x="670" y="190" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 205px; margin-left: 671px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">0</div></div></div></foreignObject><text x="725" y="209" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">0</text></switch></g><rect x="670" y="220" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 235px; margin-left: 671px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">buf1</div></div></div></foreignObject><text x="725" y="239" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">buf1</text></switch></g><rect x="670" y="250" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 265px; margin-left: 671px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">0x100</div></div></div></foreignObject><text x="725" y="269" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">0x100</text></switch></g><rect x="670" y="280" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><rect x="670" y="310" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><rect x="625" y="105" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 115px; margin-left: 645px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">ebp</div></div></div></foreignObject><text x="645" y="119" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">ebp</text></switch></g><rect x="670" y="40" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 55px; margin-left: 671px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">aaaa</div></div></div></foreignObject><text x="725" y="59" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">aaaa</text></switch></g><rect x="625" y="45" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 55px; margin-left: 645px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">esp</div></div></div></foreignObject><text x="645" y="59" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">esp</text></switch></g><rect x="700" y="0" width="50" height="20" fill="#6a00ff" stroke="#3700cc" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 10px; margin-left: 725px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: nowrap;">stack</div></div></div></foreignObject><text x="725" y="14" fill="#ffffff" font-family="Helvetica" font-size="14px" text-anchor="middle">stack</text></switch></g><rect x="1040" y="70" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 85px; margin-left: 1041px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">system</div></div></div></foreignObject><text x="1095" y="89" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">system</text></switch></g><rect x="1040" y="100" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 115px; margin-left: 1041px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">0xdeadbeef</div></div></div></foreignObject><text x="1095" y="119" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">0xdeadbeef</text></switch></g><rect x="1040" y="130" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 145px; margin-left: 1041px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">&amp;/bin/sh</div></div></div></foreignObject><text x="1095" y="149" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">&amp;/bin/sh</text></switch></g><rect x="1040" y="160" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 175px; margin-left: 1041px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">/bin/sh</div></div></div></foreignObject><text x="1095" y="179" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">/bin/sh</text></switch></g><rect x="1040" y="190" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><rect x="1040" y="220" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><rect x="1040" y="250" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><rect x="1040" y="280" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><rect x="1040" y="310" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><rect x="1040" y="40" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 55px; margin-left: 1041px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">buf1</div></div></div></foreignObject><text x="1095" y="59" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">buf1</text></switch></g><rect x="1075" y="0" width="40" height="20" fill="#6a00ff" stroke="#3700cc" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 10px; margin-left: 1095px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: nowrap;">buf2</div></div></div></foreignObject><text x="1095" y="14" fill="#ffffff" font-family="Helvetica" font-size="14px" text-anchor="middle">buf2</text></switch></g><rect x="780" y="365" width="380" height="90" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 410px; margin-left: 782px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">首先触发栈溢出<br style="font-size: 14px;" />ebp中写入buf1的地址（buf1取一个bss段的地址）<br style="font-size: 14px;" />目的是把buf1当做临时的第二个栈，后面会搬迁过去<br style="font-size: 14px;" />这次栈溢出的目的是向buf1中写入gadget<br style="font-size: 14px;" />所以应该要调用read或者gets啥的，看程序中能用啥就用啥</div></div></div></foreignObject><text x="782" y="414" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">首先触发栈溢出ebp中写入buf1的地址（buf1取一个bss段的地址）...</text></switch></g><rect x="240" y="40" width="310" height="60" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 70px; margin-left: 242px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">栈迁移最关键的利用是通过leave指令<br style="font-size: 14px;" />leave = mov esp, ebp; pop ebp;<br style="font-size: 14px;" />通过pop ebp; 把ebp指到恶意构造的地址上去！</div></div></div></foreignObject><text x="242" y="74" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">栈迁移最关键的利用是通过leave指令...</text></switch></g><rect x="864" y="70" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 85px; margin-left: 865px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">puts_plt</div></div></div></foreignObject><text x="919" y="89" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">puts_plt</text></switch></g><rect x="864" y="100" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 115px; margin-left: 865px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">pop_ebx; ret</div></div></div></foreignObject><text x="919" y="119" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">pop_ebx; ret</text></switch></g><rect x="864" y="130" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 145px; margin-left: 865px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">puts_got</div></div></div></foreignObject><text x="919" y="149" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">puts_got</text></switch></g><rect x="864" y="160" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 175px; margin-left: 865px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">read_plt</div></div></div></foreignObject><text x="919" y="179" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">read_plt</text></switch></g><rect x="864" y="190" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 205px; margin-left: 865px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">leave_ret</div></div></div></foreignObject><text x="919" y="209" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">leave_ret</text></switch></g><rect x="864" y="220" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 235px; margin-left: 865px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">0</div></div></div></foreignObject><text x="919" y="239" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">0</text></switch></g><rect x="864" y="250" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 265px; margin-left: 865px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">buf2</div></div></div></foreignObject><text x="919" y="269" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">buf2</text></switch></g><rect x="864" y="280" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 295px; margin-left: 865px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">0x100</div></div></div></foreignObject><text x="919" y="299" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">0x100</text></switch></g><rect x="864" y="310" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><rect x="864" y="40" width="110" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 55px; margin-left: 865px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">buf2</div></div></div></foreignObject><text x="919" y="59" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">buf2</text></switch></g><rect x="899" y="0" width="40" height="20" fill="#6a00ff" stroke="#3700cc" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 10px; margin-left: 919px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: nowrap;">buf1</div></div></div></foreignObject><text x="919" y="14" fill="#ffffff" font-family="Helvetica" font-size="14px" text-anchor="middle">buf1</text></switch></g><rect x="820" y="45" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 55px; margin-left: 840px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">ebp</div></div></div></foreignObject><text x="840" y="59" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">ebp</text></switch></g><rect x="1000" y="45" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 55px; margin-left: 1020px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">ebp</div></div></div></foreignObject><text x="1020" y="59" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">ebp</text></switch></g><path d="M 520 175 L 663.63 175" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 668.88 175 L 661.88 178.5 L 663.63 175 L 661.88 171.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="0" y="145" width="520" height="60" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 175px; margin-left: 2px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">关键点：leave_ret<br style="font-size: 14px;" />leave把ebp指到buf2(这个buf2是指最右边那排的那个)，把esp指到buf1的puts_plt<br style="font-size: 14px;" />然后ret，puts_plt放进eip中执行。</div></div></div></foreignObject><text x="2" y="179" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">关键点：leave_ret...</text></switch></g><rect x="650" y="400" width="120" height="20" fill="#6a00ff" stroke="#3700cc" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 410px; margin-left: 710px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: nowrap;">关于stack的构造</div></div></div></foreignObject><text x="710" y="414" fill="#ffffff" font-family="Helvetica" font-size="14px" text-anchor="middle">关于stack的构造</text></switch></g><rect x="655" y="524" width="110" height="20" fill="#6a00ff" stroke="#3700cc" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 534px; margin-left: 710px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: nowrap;">关于buf1的构造</div></div></div></foreignObject><text x="710" y="538" fill="#ffffff" font-family="Helvetica" font-size="14px" text-anchor="middle">关于buf1的构造</text></switch></g><rect x="780" y="495" width="650" height="180" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 585px; margin-left: 782px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">stack中的gadget触发read，向buf1中写入gadget<br style="font-size: 14px;" />首先写入的是第三个栈的地址buf2<br style="font-size: 14px;" />然后buf1这个栈的目的有两个<br style="font-size: 14px;" />1、泄露libc地址，所以一般会通过调用puts_plt，打印puts_got值<br style="font-size: 14px;" />2、继续调用read_plt，向buf2中写入gadget，这一条的思路和stack中的gadget思路是一样的<br style="font-size: 14px;" /><br style="font-size: 14px;" />puts_plt下一格是返回地址，如果这里塞read_plt的话，read_plt的返回地址就是puts_got了，<br style="font-size: 14px;" />我们想要的返回地址gadget应该是leave_ret，这样可以把栈再迁移到buf2了<br style="font-size: 14px;" />所以这一格的内容，需要修一下esp，要么用pop xxx; ret  要么用add esp, xxx; ret 或者 sub esp,xxx; ret<br style="font-size: 14px;" />这题就用 =&gt; 0x0804836d : pop ebx ; ret  这个gadget了</div></div></div></foreignObject><text x="782" y="589" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">stack中的gadget触发read，向buf1中写入gadget...</text></switch></g><rect x="655" y="750" width="110" height="20" fill="#6a00ff" stroke="#3700cc" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 760px; margin-left: 710px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: nowrap;">关于buf2的构造</div></div></div></foreignObject><text x="710" y="764" fill="#ffffff" font-family="Helvetica" font-size="14px" text-anchor="middle">关于buf2的构造</text></switch></g><rect x="780" y="725" width="830" height="70" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 760px; margin-left: 782px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">首先写入buf1的地址，再把栈迁到buf1中。也就是栈在buf1和buf2来回横跳。但是这题在buf2中就拿到shell了，不会再回到buf1<br style="font-size: 14px;" />buf2这个栈的目的是执行system("/bin/sh")<br style="font-size: 14px;" />system的地址通过buf1中的leak可以计算到<br style="font-size: 14px;" />/bin/sh在libc中也有。假设没有现成的/bin/sh的话，/bin/sh可以在buf2中写入，然后稍微计算一下偏移，把这个地址传给system做参数</div></div></div></foreignObject><text x="782" y="764" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">首先写入buf1的地址，再把栈迁到buf1中。也就是栈在buf1和buf2来回横跳。但是这题在buf2中就拿到shell了，不会再回到buf1...</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>